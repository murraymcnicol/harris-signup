<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harris Weekend Trip - Booking Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .form-container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        select {
            height: 40px;
        }
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }
        .radio-option {
            display: flex;
            align-items: center;
        }
        .radio-option input {
            margin-right: 5px;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        .checkbox-group input {
            margin-right: 10px;
        }
        .info-box {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        .accommodation-details {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        .submit-section {
            margin-top: 30px;
            text-align: center;
        }
        button {
            background-color: #3498db;
            color: white;
            padding: 12px 40px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .note {
            font-style: italic;
            color: #7f8c8d;
            font-size: 14px;
            margin-top: 10px;
        }
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        .loading {
            display: none;
            color: #3498db;
            font-weight: bold;
        }
        .required {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h1>Harris Weekend Trip Booking Form</h1>
        <div class="info-box">
            <strong>Trip Dates:</strong> Friday 8th May - Monday 11th May 2026<br>
            <strong>Location:</strong> Harris, Outer Hebrides, Scotland
        </div>

        <div id="successMessage" class="success-message">
            Thank you! Your booking has been submitted successfully. You'll receive a confirmation email shortly.
        </div>
        
        <div id="errorMessage" class="error-message">
            There was an error submitting your form. Please try again or contact Murray directly.
        </div>

        <form id="harrisBookingForm">
            <h2>Personal Information</h2>
            
            <div class="form-group">
                <label for="name">Full Name <span class="required">*</span></label>
                <input type="text" id="name" name="name" required>
            </div>

            <div class="form-group">
                <label for="email">Email Address <span class="required">*</span></label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone">
            </div>

            <h2>Accommodation Preferences</h2>

            <div class="form-group">
                <label for="accommodation">Preferred Accommodation <span class="required">*</span></label>
                <select id="accommodation" name="accommodation" required onchange="updateAccommodationDetails()">
                    <option value="">-- Please select --</option>
                    <option value="drinishader-bunk">Drinishader No.5 - Bunk Room (4 beds)</option>
                    <option value="drinishader-double">Drinishader No.5 - Double Room</option>
                    <option value="ceol-na-mara">Ceol Na Mara - Twin Room</option>
                    <option value="harris-twin">Harris Hotel - Twin Room</option>
                    <option value="harris-double">Harris Hotel - Double Room</option>
                    <option value="harris-single">Harris Hotel - Single Room</option>
                    <option value="hotel-hebrides">Hotel Hebrides - Single Room</option>
                </select>
                <div id="accommodationDetails" class="accommodation-details" style="display: none;"></div>
            </div>

            <div class="form-group">
                <label for="nights">Number of Nights <span class="required">*</span></label>
                <select id="nights" name="nights" required>
                    <option value="">-- Please select --</option>
                    <option value="1">1 night</option>
                    <option value="2">2 nights</option>
                    <option value="3">3 nights (Full weekend)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="checkin">Check-in Date <span class="required">*</span></label>
                <select id="checkin" name="checkin" required>
                    <option value="">-- Please select --</option>
                    <option value="Friday 8th May">Friday 8th May</option>
                    <option value="Saturday 9th May">Saturday 9th May</option>
                    <option value="Sunday 10th May">Sunday 10th May</option>
                </select>
            </div>

            <div class="form-group" id="breakfastOption" style="display: none;">
                <label>Add Breakfast? (£8 per day)</label>
                <div class="checkbox-group">
                    <input type="checkbox" id="breakfast" name="breakfast">
                    <label for="breakfast" style="font-weight: normal;">Yes, I would like to add breakfast</label>
                </div>
            </div>

            <div class="form-group">
                <label for="roomShare">Room Sharing Preference</label>
                <input type="text" id="roomShare" name="roomShare" placeholder="Name of person you'd like to share with (if applicable)">
            </div>

            <h2>St Kilda Boat Trip</h2>
            <div class="info-box">
                <strong>Limited to 12 guests per day</strong><br>
                Visit the UNESCO World Heritage Site of St Kilda - one of the most remote parts of the British Isles
            </div>

            <div class="form-group">
                <label>Would you like to join the St Kilda boat trip? <span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="boatYes" name="boatTrip" value="yes" onchange="toggleBoatDay()" required>
                        <label for="boatYes" style="font-weight: normal;">Yes</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="boatNo" name="boatTrip" value="no" onchange="toggleBoatDay()" required>
                        <label for="boatNo" style="font-weight: normal;">No</label>
                    </div>
                </div>
            </div>

            <div class="form-group" id="boatDaySelection" style="display: none;">
                <label>Preferred Day for Boat Trip <span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="saturday" name="boatDay" value="Saturday 9th May">
                        <label for="saturday" style="font-weight: normal;">Saturday 9th May</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="sunday" name="boatDay" value="Sunday 10th May">
                        <label for="sunday" style="font-weight: normal;">Sunday 10th May</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="eitherDay" name="boatDay" value="Either day works">
                        <label for="eitherDay" style="font-weight: normal;">Either day works for me</label>
                    </div>
                </div>
            </div>

            <h2>Additional Information</h2>

            <div class="form-group">
                <label for="dietary">Dietary Requirements</label>
                <input type="text" id="dietary" name="dietary" placeholder="Please list any dietary requirements or allergies">
            </div>

            <div class="form-group">
                <label for="comments">Additional Comments</label>
                <textarea id="comments" name="comments" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: Arial, sans-serif; font-size: 14px; box-sizing: border-box;" placeholder="Any other information or special requests"></textarea>
            </div>

            <div class="submit-section">
                <button type="submit" id="submitButton">Submit Booking</button>
                <div id="loadingMessage" class="loading">Submitting your booking...</div>
                <p class="note">Your information will be securely submitted to Murray</p>
            </div>
        </form>
    </div>

    <script>
        // IMPORTANT: Replace this with your actual Google Apps Script Web App URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzf4Nl16pSgFO8X___ftMNwBN9ixtqH2sTTqjHhm2QXsY730jVzAkfzqwld11RBTCs/exec';
        
        // Accommodation information
        const accommodationInfo = {
            'drinishader-bunk': {
                details: 'Price: £25 per night (room only) • Sleeps 4 • Breakfast available for £8',
                name: 'Drinishader No.5',
                roomType: 'Bunk Room (4 beds)'
            },
            'drinishader-double': {
                details: 'Price: £75 per night (room only) • Sleeps 2 • Breakfast available for £8',
                name: 'Drinishader No.5',
                roomType: 'Double Room'
            },
            'ceol-na-mara': {
                details: 'Price: £225 per night • Twin room • Breakfast included',
                name: 'Ceol Na Mara',
                roomType: 'Twin Room'
            },
            'harris-twin': {
                details: 'Price: £189 per night • Twin room • Breakfast included • 5 rooms available',
                name: 'Harris Hotel',
                roomType: 'Twin Room'
            },
            'harris-double': {
                details: 'Price: £189 per night • Double room • Breakfast included • 6 rooms available',
                name: 'Harris Hotel',
                roomType: 'Double Room'
            },
            'harris-single': {
                details: 'Price: £159 per night • Single room • Breakfast included',
                name: 'Harris Hotel',
                roomType: 'Single Room'
            },
            'hotel-hebrides': {
                details: 'Price: £130 per night • Single room • Breakfast included • 2 rooms available',
                name: 'Hotel Hebrides',
                roomType: 'Single Room'
            }
        };

        function updateAccommodationDetails() {
            const select = document.getElementById('accommodation');
            const details = document.getElementById('accommodationDetails');
            const breakfastOption = document.getElementById('breakfastOption');
            
            if (select.value && accommodationInfo[select.value]) {
                details.innerHTML = accommodationInfo[select.value].details;
                details.style.display = 'block';
                
                // Show breakfast option only for Drinishader
                if (select.value.includes('drinishader')) {
                    breakfastOption.style.display = 'block';
                } else {
                    breakfastOption.style.display = 'none';
                    document.getElementById('breakfast').checked = false;
                }
            } else {
                details.style.display = 'none';
                breakfastOption.style.display = 'none';
            }
        }

        function toggleBoatDay() {
            const boatYes = document.getElementById('boatYes').checked;
            const boatDaySelection = document.getElementById('boatDaySelection');
            const boatDayRadios = document.getElementsByName('boatDay');
            
            if (boatYes) {
                boatDaySelection.style.display = 'block';
                // Make boat day selection required
                boatDayRadios.forEach(radio => radio.required = true);
            } else {
                boatDaySelection.style.display = 'none';
                // Clear selection and remove required when hiding
                boatDayRadios.forEach(radio => {
                    radio.checked = false;
                    radio.required = false;
                });
            }
        }

        // Form submission handler
        document.getElementById('harrisBookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check if Google Script URL has been set
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                alert('Please update the Google Apps Script URL in the JavaScript code before submitting.');
                return;
            }
            
            // Show loading message
            document.getElementById('submitButton').disabled = true;
            document.getElementById('loadingMessage').style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            
            // Get form data
            const formData = new FormData(e.target);
            const accommodationValue = formData.get('accommodation');
            
            // Prepare data object
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                accommodationName: accommodationInfo[accommodationValue]?.name || '',
                roomType: accommodationInfo[accommodationValue]?.roomType || '',
                nights: formData.get('nights'),
                checkin: formData.get('checkin'),
                breakfast: document.getElementById('breakfast').checked ? 'Yes' : 
                           (accommodationValue?.includes('drinishader') ? 'No' : 'Included'),
                roomShare: formData.get('roomShare'),
                boatTrip: formData.get('boatTrip'),
                boatDay: formData.get('boatTrip') === 'yes' ? formData.get('boatDay') : 'N/A',
                dietary: formData.get('dietary'),
                comments: formData.get('comments')
            };
            
            // Submit to Google Sheets
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Important for Google Apps Script
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                // With no-cors, we can't read the response, so we assume success
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('harrisBookingForm').reset();
                document.getElementById('accommodationDetails').style.display = 'none';
                document.getElementById('breakfastOption').style.display = 'none';
                document.getElementById('boatDaySelection').style.display = 'none';
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('errorMessage').style.display = 'block';
            })
            .finally(() => {
                document.getElementById('submitButton').disabled = false;
                document.getElementById('loadingMessage').style.display = 'none';
            });
        });
    </script>
</body>
</html>
